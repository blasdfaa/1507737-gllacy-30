const feedbackModal=document.querySelector(".modal-feedback"),overlay=document.querySelector(".overlay"),feedbackButton=document.querySelector(".contacts__btn"),feedbackForm=document.querySelector(".modal-feedback__form"),feedbackClose=feedbackModal.querySelector(".modal-feedback__close"),emailInput=feedbackModal.querySelector("[name=user-email]"),userNameInput=feedbackModal.querySelector("[name=feedback-name]"),messageInput=feedbackModal.querySelector("[name=feedback-message]");let userNameStorage,emailStorage,messageStorage,inStorageSupport=!0;try{userNameStorage=localStorage.getItem("user-name"),emailStorage=localStorage.getItem("user-email"),popupEmailStorage=localStorage.getItem("popup-user-email"),messageStorage=localStorage.getItem("user-message")}catch(e){inStorageSupport=!1}feedbackButton.addEventListener("click",e=>{feedbackModal.classList.add("modal-feedback--show"),overlay.classList.add("overlay--show"),userNameStorage?(userNameInput.value=userNameStorage,emailInput.focus()):userNameInput.focus(),emailStorage?(emailInput.value=emailStorage,messageInput.focus()):emailInput.focus(),messageStorage&&(messageInput.value=messageStorage,userNameInput.focus())}),feedbackClose.addEventListener("click",()=>{localStorage.setItem("user-name",userNameInput.value),localStorage.setItem("user-email",emailInput.value),localStorage.setItem("user-message",messageInput.value),feedbackModal.classList.remove("modal-feedback--show"),overlay.classList.remove("overlay--show"),feedbackModal.classList.remove("modal-feedback--error")}),feedbackForm.addEventListener("submit",e=>{userNameInput.value&&emailInput.value&&messageInput.value||(e.preventDefault(),feedbackModal.classList.remove("modal-feedback--error"),feedbackModal.offsetWidth=feedbackModal.offsetWidth,feedbackModal.classList.add("modal-feedback--error")),localStorage.removeItem("user-name"),localStorage.removeItem("user-email"),localStorage.removeItem("user-message")}),window.addEventListener("keyup",e=>{27===e.keyCode&&feedbackModal.classList.contains("modal-feedback--show")&&overlay.classList.contains("overlay--show")&&(e.preventDefault(),feedbackModal.classList.remove("modal-feedback--show"),overlay.classList.remove("overlay--show"))});const popupLoginBtn=document.querySelector(".usermenu__link--login"),popupLogin=document.querySelector(".popup-login"),loginForm=popupLogin.querySelector(".popup-login__form"),popupEmailInput=popupLogin.querySelector("[name=user-email]"),passwordInput=popupLogin.querySelector("[name=password]");function init(){const e=new ymaps.Map("map",{center:[59.93942,30.329657],zoom:16,controls:["zoomControl"],behaviors:["drag"]}),a=new ymaps.Placemark([59.938635,30.323118],{hintContent:'<div class="contacts__hint">ул. Большая Конюшенная, 19/8</div>'},{iconLayout:"default#image",iconImageHref:"img/icons/pin-map.svg",iconImageSize:[80,140],iconImageOffset:[-30,-153]});e.geoObjects.add(a)}popupLoginBtn.addEventListener("mousemove",()=>{popupEmailStorage?(popupEmailInput.value=popupEmailStorage,passwordInput.focus()):popupEmailInput.focus()}),loginForm.addEventListener("submit",e=>{popupEmailInput.value&&passwordInput.value?localStorage.setItem("popup-user-email",popupEmailInput.value):(e.preventDefault(),console.log("Ошибка! Есть незаполненные поля"))}),popupLogin.addEventListener("mouseout",()=>{localStorage.setItem("popup-user-email",popupEmailInput.value),popupEmailInput.blur(),passwordInput.blur()}),popupLoginBtn.addEventListener("mouseout",()=>{popupEmailInput.blur(),passwordInput.blur()}),ymaps.ready(init);
